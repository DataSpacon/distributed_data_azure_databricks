{"cells":[{"cell_type":"code","source":["\nspark.databricks.chauffeur.enableIdleContextTracking\n"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"cb540c02-7cef-41e9-b1ce-114f0896b467","inputWidgets":{},"title":""}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"data":"\u001B[0;31m---------------------------------------------------------------------------\u001B[0m\n\u001B[0;31mAttributeError\u001B[0m                            Traceback (most recent call last)\n\u001B[0;32m<command-1391817431974752>\u001B[0m in \u001B[0;36m<cell line: 1>\u001B[0;34m()\u001B[0m\n\u001B[0;32m----> 1\u001B[0;31m \u001B[0mspark\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0mdatabricks\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0mchauffeur\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0menableIdleContextTracking\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\n\u001B[0m\n\u001B[0;31mAttributeError\u001B[0m: 'SparkSession' object has no attribute 'databricks'","errorSummary":"<span class='ansi-red-fg'>AttributeError</span>: 'SparkSession' object has no attribute 'databricks'","metadata":{},"errorTraceType":"ansi","type":"ipynbError","arguments":{}}},"output_type":"display_data","data":{"text/plain":["\u001B[0;31m---------------------------------------------------------------------------\u001B[0m\n\u001B[0;31mAttributeError\u001B[0m                            Traceback (most recent call last)\n\u001B[0;32m<command-1391817431974752>\u001B[0m in \u001B[0;36m<cell line: 1>\u001B[0;34m()\u001B[0m\n\u001B[0;32m----> 1\u001B[0;31m \u001B[0mspark\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0mdatabricks\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0mchauffeur\u001B[0m\u001B[0;34m.\u001B[0m\u001B[0menableIdleContextTracking\u001B[0m\u001B[0;34m\u001B[0m\u001B[0;34m\u001B[0m\u001B[0m\n\u001B[0m\n\u001B[0;31mAttributeError\u001B[0m: 'SparkSession' object has no attribute 'databricks'"]}}],"execution_count":0},{"cell_type":"code","source":["print(spark.conf.get(\"spark.databricks.clusterUsageTags.sparkVersion\"))"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"7d39a205-b532-47c0-8322-93660e516697","inputWidgets":{},"title":""}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"11.3.x-scala2.12\n","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"ansi","arguments":{}}},"output_type":"display_data","data":{"text/plain":["11.3.x-scala2.12\n"]}}],"execution_count":0},{"cell_type":"code","source":["spark.version"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"267ae740-81e8-4c31-9af5-b7ace041d6c2","inputWidgets":{},"title":""}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"Out[4]: '3.3.0'","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"ansi","arguments":{}}},"output_type":"display_data","data":{"text/plain":["Out[4]: '3.3.0'"]}}],"execution_count":0},{"cell_type":"code","source":["%sh\nls"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"13fa40b8-2f20-4d2e-a241-5be17019d6c8","inputWidgets":{},"title":""}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">azure\nconf\neventlogs\nhadoop_accessed_config.lst\nlogs\npreload_class.lst\n</div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">azure\nconf\neventlogs\nhadoop_accessed_config.lst\nlogs\npreload_class.lst\n</div>"]}}],"execution_count":0},{"cell_type":"markdown","source":["### Using %conda allows us to save, reuse or share an environment."],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"8660db93-cd17-4621-870b-b4ba831dfe7a","inputWidgets":{},"title":""}}},{"cell_type":"code","source":["%conda env export -f /dbfs/sub_dir/my_env.yml"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"71910e6f-84c7-40f5-9cb6-60fdb395cda7","inputWidgets":{},"title":""}},"outputs":[],"execution_count":0},{"cell_type":"markdown","source":["Import back"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"1bf7065f-f664-4e0d-9915-9bf0efca4c33","inputWidgets":{},"title":""}}},{"cell_type":"code","source":["%conda env update -f /dbfs/sub_dir/my_env.yml"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"cb8aa105-b31b-4966-b418-58ce41e9689b","inputWidgets":{},"title":""}},"outputs":[],"execution_count":0},{"cell_type":"markdown","source":["#### Libraries\nWe cannot uninstall any libraries included in the Databricks Runtime or any installed at cluster level."],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"2e7031cb-623e-4bba-b9ea-093341204308","inputWidgets":{},"title":""}}},{"cell_type":"code","source":["%pip install pandas==2.1\n# Wheel package - we need to rename it first to keep it consistenth with a naming convention\n# (importing to dbfs, removes special characters)\n%pip install /dbfs/mypackage-0,0,1-py3-none-any.whl\n%pip install /path/to/my_package.whl\n# to uninstall, it is necessary to pass the -y option to say yes as default, because there is no keyboard input when running this option\n%pip uninstall -y pandas\n# Requirements file\n\n%pip freeze > /dbfs/sub_dir/requirements.txt\n%pip install  -r /dbfs/sub_dir/requirements.txt\n"],"metadata":{"application/vnd.databricks.v1+cell":{"showTitle":false,"cellMetadata":{},"nuid":"a66dc3f4-fac3-40b7-98a7-227cd0b79b48","inputWidgets":{},"title":""}},"outputs":[],"execution_count":0}],"metadata":{"application/vnd.databricks.v1+notebook":{"notebookName":"First_basic","dashboards":[],"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":1391817431974755,"dataframes":["_sqldf"]}},"language":"python","widgets":{},"notebookOrigID":1391817431974751}},"nbformat":4,"nbformat_minor":0}
